graph TD
    %% Estilo dos Componentes
    classDef student fill:#10B981,fill-opacity:0.1,stroke:#10B981,stroke-width:2px,color:#064E3B
    classDef instructor fill:#059669,fill-opacity:0.1,stroke:#059669,stroke-width:2px,color:#064E3B
    classDef admin fill:#047857,fill-opacity:0.1,stroke:#047857,stroke-width:2px,color:#064E3B
    classDef app fill:#F3F4F6,stroke:#6B7280,stroke-width:2px,color:#111827
    classDef backend fill:#FEF3C7,stroke:#F59E0B,stroke-width:2px,color:#78350F
    classDef payment fill:#DBEAFE,stroke:#3B82F6,stroke-width:2px,color:#1E3A8A
    classDef database fill:#EDE9FE,stroke:#8B5CF6,stroke-width:2px,color:#4C1D95
    classDef security fill:#FEE2E2,stroke:#EF4444,stroke-width:2px,color:#7F1D1D
    classDef process fill:#D1FAE5,stroke:#10B981,stroke-width:2px,color:#064E3B

    %% Atores
    S[ðŸ‘¨â€ðŸŽ“ Estudante\naluno@gmail.com]:::student
    I[ðŸ‘¨â€ðŸ« Instrutor\ninstrutor@gmail.com]:::instructor
    A[ðŸ‘¤ Administrador]:::admin

    %% Sistema
    APP[ðŸ“± Go Drive App]:::app
    BACKEND[ðŸ–¥ï¸ Backend Render]:::backend
    DB[ðŸ—„ï¸ Banco Neon]:::database
    MP[ðŸ’³ Mercado Pago]:::payment

    %% SeguranÃ§a
    CPF[ðŸ” ValidaÃ§Ã£o CPF]:::security
    TOKEN[ðŸ” TokenizaÃ§Ã£o]:::security

    %% Processos
    TAX[ðŸ’° Taxa 12% Delta Pro]:::process
    ESCROW[ðŸ”’ Sistema Escrow]:::process
    RELEASE[ðŸ’¸ LiberaÃ§Ã£o Pagamento]:::process

    %% Status Aula
    PENDING[â³ PENDING_PAYMENT]:::process
    CONFIRMED[âœ… CONFIRMED]:::process
    INPROGRESS[ðŸš— IN_PROGRESS]:::process
    COMPLETED[ðŸŽ¯ COMPLETED]:::process

    %% Fluxo Principal
    S -->|1. Busca Instrutor|APP
    S -->|2. Dados CartÃ£o|TOKEN
    TOKEN -->|3. TokenizaÃ§Ã£o Segura|APP
    APP -->|4. Cria PreferÃªncia|MP
    MP -->|5. Processamento|MP
    MP -->|6. Webhook ConfirmaÃ§Ã£o|BACKEND

    %% ValidaÃ§Ã£o
    APP -->|ValidaÃ§Ã£o CPF|CPF
    CPF -->|LGPD Check|BACKEND
    BACKEND -->|Dados Seguros|DB

    %% LÃ³gica Financeira
    BACKEND -->|Grava TransaÃ§Ã£o|DB
    BACKEND -->|Calcula Taxa|TAX
    TAX -->|12% Platform Fee|BACKEND
    BACKEND -->|Divide Saldo|ESCROW

    %% Fluxo Carteira Aluno
    ESCROW -->|CrÃ©dito Bloqueado|DB
    DB -->|Saldo: Bloqueado|S

    %% Fluxo Pagamento Instrutor
    ESCROW -->|Saldo Retido|DB
    DB -->|Saldo: DisponÃ­vel|I

    %% Ciclo Vida Aula
    APP -->|Agendamento|PENDING
    PENDING -->|Pagamento OK|CONFIRMED
    CONFIRMED -->|InÃ­cio Aula|INPROGRESS
    INPROGRESS -->|Aula ConcluÃ­da|COMPLETED

    %% LiberaÃ§Ã£o Financeira
    COMPLETED -->|Trigger LiberaÃ§Ã£o|RELEASE
    RELEASE -->|Desbloqueia Saldo|DB
    DB -->|Saldo Liberado|I
    DB -->|Saldo Utilizado|S

    %% AdministraÃ§Ã£o
    A -->|Monitoramento|BACKEND
    A -->|RelatÃ³rios|DB
    BACKEND -->|Dashboard|A

    %% ComunicaÃ§Ã£o
    I -->|Aceita/Rejeita|APP
    APP -->|AtualizaÃ§Ã£o Status|BACKEND
    BACKEND -->|NotificaÃ§Ã£o|S
    BACKEND -->|NotificaÃ§Ã£o|I

    %% IntegraÃ§Ãµes
    MP -.->|API REST|BACKEND
    BACKEND -.->|Webhooks|MP
    BACKEND -.->|SQL|DB
